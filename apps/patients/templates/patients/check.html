{% extends '_base.html' %}

<!-- Static files django label -->
{% load static %}

<!-- this page specific styles -->
{% block style %}
    <link rel="stylesheet" href="{% static 'css/compiled/user-profile.css' %}" type="text/css" media="screen"
          xmlns="http://www.w3.org/1999/html"/>
    <link rel="stylesheet" href="{% static 'css/compiled/ui-elements.css' %}" type="text/css" media="screen" />
{% endblock %}

{% block title %} Paciente {% endblock %}

{% block active-patients %} class="active" {% endblock %}

{% block content %}
    <div id="pad-wrapper" class="user-profile">
        <!-- header -->
        <div class="row header" style="margin-bottom: 20px;">
            <div class="col-md-8">
                <h4 class="name">{{ patient.name }}</h4>
                <span class="area">{{ patient.dni }}</span>
            </div>
            <form class="form-horizontal" role="form" action="{% url 'create_sequence' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="direct_appointment" id="direct_appointment" value="1">
                <input type="hidden" name="date" id="date" value="{% now "m/d/Y" %}">
                <input type="hidden" name="shift" id="shift" value="{% now "A" %}">
                <input type="hidden" name="doctor_username" id="doctor_username" value="{{ auth_user.username }}">
                <input type="hidden" name="patient_dni" id="patient_dni" value="{{ patient.dni }}">
                <button class="btn-flat icon large pull-right edit">
                    Levar paciente ao processo de atendimento
                </button>
            </form>
        </div>

        <div class="row profile">
            <!-- bio, new note & orders column -->
            <div class="col-md-9 bio">
                <div class="profile-box">
                    <form class="form-horizontal" role="form" action="{% url 'check_patient' patient.dni %}" method="post">
                        {% csrf_token %}
                        <!-- new comment form -->
                        <div class="col-md-12 section comment" style="margin-top: 0; margin-bottom: 100px;">
                            <h6>Faça Uma Breve Descrição Sobre o Paciente</h6>
                            <p>Adicione uma observação sobre este usuário para manter um histórico de seus prontuários.</p>
                            <label for="notes" ></label>
                            <textarea name="notes" id="notes" required>{{ patient.notes }}</textarea>
                            <div class="col-md-12 submit-box pull-right">
                                <input type="submit" class="btn-glow primary" value="Atualizar">
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- side address column -->
            <div class="col-md-3 col-xs-12 address pull-right">
                <h6>Endereço</h6>
                <iframe width="300" height="133" scrolling="no" src="https://maps.google.com.mx/?ie=UTF8&amp;t=m&amp;ll=22.0622284,-44.0478846,8&amp;spn=42.7076107&amp;z=14&amp;output=embed"></iframe>
                <ul>
                    <li>{{ patient.address }}</li>
                    <li class="ico-li">
                        <i class="ico-phone"></i>
                        {{ patient.phone }}
                    </li>
                     <li class="ico-li">
                        <i class="ico-mail"></i>
                        <a href="mailto:{{ patient.email }}">{{ patient.email }}</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="row profile" style="margin-top: 50px; padding: 0 20px;">
            <div class="">
                <form class="form-horizontal" role="form" action="{% url 'create_diagnostic' patient.dni %}" method="post">
                    {% csrf_token %}
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th class="col-md-1">
                                    Codigo
                                </th>
                                <th class="col-md-1">
                                    <span class="line"></span>
                                    Situação
                                </th>
                                <th class="col-md-1">
                                    <span class="line"></span>
                                    Data
                                </th>
                                <th class="col-md-2">
                                    <span class="line"></span>
                                    Doutor
                                </th>
                                <th class="col-md-3">
                                    <span class="line"></span>
                                    Dentes
                                </th>
                                <th class="col-md-3">
                                    <span class="line"></span>
                                    Diagnostico
                                </th>
                                <th class="col-md-1">
                                    <span class="line"></span>
                                    Ação
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if diagnostics != None %}
                                {% for diagnostic in diagnostics %}
                                    <!-- results row -->
                                    <tr class="first">
                                        <td>
                                            {{ diagnostic.code }}
                                        </td>
                                        <td>
                                            {% if diagnostic.status == 0 %}
                                                <span class="label label-info">Pendente</span>
                                            {% else %}
                                                <span class="label label-success">Completo</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            {{ diagnostic.date }}
                                        </td>
                                        <td>
                                            {{ diagnostic.doctor_name }}
                                        </td>
                                        <td>
                                            {{ diagnostic.tooths }}
                                        </td>
                                        <td>
                                            {{ diagnostic.diagnostic }}
                                        </td>
                                        <td>
                                            {% if diagnostic.status == 0 %}
                                                <a href="{% url 'delete_diagnostic' patient.dni diagnostic.code %}" class="btn-flat icon pull-left delete-user" data-toggle="tooltip" title="Delete" data-placement="top">
                                                    <i class="icon-trash"></i>
                                                </a>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                            {% else %}
                                <tr class="first">
                                    <td colspan="4">Não há registros.</td>
                                </tr>
                            {% endif %}
                            <!-- new item row -->
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <input type="text" class="form-control inline-input" name="status" id="status" placeholder="" value="Pendente" readonly>
                                </td>
                                <td>
                                    <input type="text" class="form-control inline-input" name="date" id="date" placeholder="" value="{% now "m/d/Y" %}" readonly required>
                                </td>
                                <td>
                                    <input type="text" class="form-control inline-input" name="doctor" id="doctor" placeholder="" value="{{ auth_user.username }}" readonly required>
                                </td>
                                <td>
                                    <input type="text" class="form-control inline-input" name="tooths" id="tooths" placeholder="Dentes" required>
                                </td>
                                <td>
                                    <input type="text" class="form-control inline-input" name="diagnostic" id="diagnostic" placeholder="Diagnostico" required>
                                </td>
                                <td>
                                    <input type="submit" class="btn-glow primary" value="Adicionar andamento ao historico">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>

        <div class="row" style="margin-top: 40px;">
            <a href="{% url 'patients' %}" class="btn-flat success pull-left">Voltar</a>
        </div>

    </div>
{% endblock %}
